---
layout: post
title: "Test"
author: "Karthik"
categories: journal
tags: [documentation,sample]
---

Test, $ x^2 \geq 0 $. 

```
def square(x): 
    return x**2 
```

**Def** [Local extrema]:    
Let ${ E }$ be a complete normed space,  ${ f : U (\subseteq E \text{ open}) \to \mathbb{R} , }$ and ${ p \in U . }$    
We say ${ f }$ has a local minimum at ${ p }$ if there is an ${ r > 0 }$ such that 

$${ f(p) \leq f(x) \, \, \text{ for all } x  \in B(p, r).  }$$    

We say ${ f }$ has a strict local minimum at ${ p }$ if there is an ${ r > 0 }$ such that 

$${ f(p) < f(x) \, \, \text{ for all }  x \in B(p, r), x \neq 0. }$$    

Local maximum and strict local maximum are defined similarly. 

> We see ${ f }$ has a local maximum at ${ p }$ if and only if ${ - f }$ has a local minimum at ${ p ,}$ and ${ f }$ has a strict local maximum at ${ p }$ if and only if ${ - f }$ has a strict local minimum at ${ p . }$ 

**Obs** [Necessary condition for local min]:    
Let ${ E }$ be a complete normed space, ${ f : U (\subseteq E \text{ open}) \to \mathbb{R} , }$ and ${ p \in U .}$ Let ${ f }$ be differentiable at ${ p .}$ Now 

$${ f \text{ has a local minimum at } p  \implies Df(p) = 0 .   }$$ 

**Pf**: Say ${ f }$ has a local minimum at ${ p . }$ Let ${ h \in E, h \neq 0 . }$ It suffices to show ${ Df(p) \, h = 0 . }$    
For some ${ \varepsilon > 0 }$ we have 

$${ g : (- \varepsilon, \varepsilon) \longrightarrow \mathbb{R}, \quad g(t) := f(p + th). }$$ 

Note ${ g }$ is differentiable at ${ 0 }$ and has a local minimum at ${ 0 .}$ So ${ g ^{’} (0) = 0 }$ that is ${ Df(p) \, h = 0 , }$ as needed. 

**Thm** [Necessary condition for local min]:    
Let ${ f : U(\subseteq \mathbb{R} ^n \text{ open}) \to \mathbb{R} }$ be a ${ C ^2 }$ map, and ${ p \in U .}$ Now 

$${ \boxed{\begin{align*} &f \text{ has a local minimum at } p \\ \implies &Df(p) = 0, \, Hf(p) \geq 0  .\end{align*}} }$$ 

**Pf**: By Taylor’s theorem, (for ${ h }$ in a neighbourhood of ${ 0 }$)

$${ \begin{align*} &f(p+h) =  f(p) + Df(p) \, h + \frac{1}{2} h ^T Hf(p) \, h  + \lVert h \rVert ^2 \varphi (h) \\ &\text{with }  \varphi(0) = 0 \text{ and } \varphi \text{ continuous at } 0 . \end{align*}  }$$ 

Say ${ f }$ has a local minimum at ${ p . }$ By previous observation, ${ Df(p) = 0 . }$ Let ${ e }$ be a unit vector in ${ \mathbb{R} ^n . }$ It suffices to show 

$${ \text{To show: } \quad e ^T Hf(p) \, e \geq 0 . }$$

Putting ${ h = te }$ above and using local minimality, (for ${ t }$ in a neighbourhood of ${ 0 }$) 

$${ \begin{align*} f(p+te) - f(p) = &\, \frac{t ^2}{2} e ^T Hf(p) \, e + t ^2 \varphi(te) \geq 0 .  \end{align*} }$$ 

Let ${ \varepsilon > 0 . }$ By continuity of ${ \varphi }$ at ${ 0 , }$ we have for ${ t }$ in a neighbourhood of ${ 0 }$ 

$${ \begin{align*} &\frac{t ^2}{2} e ^T Hf(p) \, e + t ^2 \varphi(te) \geq 0 \\ &\text{and } \vert \varphi (t e) \vert < \varepsilon. \end{align*} }$$ 

For ${ t \neq 0 }$ in this neighbourhood

$${ \begin{align*}  e ^T Hf(p) \, e &\geq  -2 \varphi(t e) \\ &>  - 2 \varepsilon. \end{align*}  }$$ 

So ${ e ^T Hf(p) \, e > - 2 \varepsilon }$ for every ${ \varepsilon > 0 , }$ that is ${ e ^T Hf(p) \, e \geq 0  }$ as needed. ${ \blacksquare }$ 

**Thm** [Sufficient condition for local min]:    
Let ${ f : U(\subseteq \mathbb{R} ^n \text{ open}) \to \mathbb{R} }$ be a ${ C ^2 }$ map, and ${ p \in U .}$ Now 

$${ \boxed{\begin{align*} &Df(p) = 0, Hf(p) > 0 \\ \implies &f \text{ has a strict local minimum at } p .  \end{align*}}  }$$ 

**Pf**: Say ${ Df(p) = 0 }$ and ${ Hf(p) > 0 . }$ We are to show ${ f }$ has a strict local minimum at ${ p . }$    
By Taylor’s theorem, (for ${ h }$ in a neighbourhood of ${ 0 }$)

$${  \begin{align*} &f(p+h) =  f(p) + \frac{1}{2} h ^T Hf(p) \, h  + \lVert h \rVert ^2 \varphi (h) \\ &\text{with }  \varphi(0) = 0 \text{ and } \varphi \text{ continuous at } 0 . \end{align*}  }$$ 

The form ${ e \mapsto e ^T Hf(p) \, e > 0 }$ is continuous on the compact unit sphere. So there is a unit vector ${ e _0 }$ such that 

$${ \min _{\lVert e \rVert = 1} e ^T Hf(p) \, e = e _0 ^T Hf(p) \, e _0 > 0 .  }$$ 

Hence (for ${ h }$ in a neighbourhood of ${ 0 }$) 

$${ \begin{align*} &f(p+h) - f(p) \\ = &\,  \frac{1}{2} h ^T Hf(p) \, h  + \lVert h \rVert ^2 \varphi (h) \\ \geq  &\, \frac{1}{2}  \lVert h \rVert ^2 (\underbrace{e _0 ^T Hf(p) \, e _0} _{ = \, \alpha > 0 } ) +  \lVert h \rVert ^2 \varphi (h )  \\ = &\, \lVert h \rVert ^2 \left( \frac{\alpha}{2} + \varphi(h) \right) . \end{align*}  }$$ 

By continuity of ${ \varphi }$ at ${ 0 ,}$ we have for ${ h }$ in a neighbourhood of ${ 0 }$

$${ \begin{align*} &f(p+h) - f(p) \geq  \lVert h \rVert ^2 \left( \frac{\alpha}{2} + \varphi(h) \right) \\ &\text{and } \vert \varphi (h) \vert < \frac{\alpha}{4}.  \end{align*} }$$

For ${ h \neq 0 }$ in this neighbourhood 

$${ \begin{align*} f(p+h) - f(p) \geq &\, \lVert h \rVert ^2 \left( \frac{\alpha}{2} + \varphi (h)  \right)  \\ > &\, \lVert h \rVert ^2 \left( \frac{\alpha}{2} - \frac{\alpha}{4} \right) \\  > &\, 0   \end{align*} }$$ 

as needed. ${ \blacksquare }$ 

###### 

$${ \underline{\textbf{Inverse function theorem}} }$$ 

**Thm** [Contraction maps have a unique fixed point]:    
Let ${ (X, d) }$ be a complete metric space and ${ T : X \to X .}$ Suppose there is a ${ K \in (0, 1) }$ such that 

$${ d(T(x), T(y)) \leq K d(x, y) \quad \text{ for all } x, y \in X . }$$ 

Then ${ T }$ has a unique fixed point (i.e. there is a unique ${ p \in X }$ such that ${ T(p) = p  }$). Also, for any ${ x \in X 
}$ the sequence of iterates ${ (T ^n (x)) }$ converges to this fixed point. 

**Pf**: Firstly, if at all a fixed point exists it is unique: Say ${ p _1, p _2 \in X }$ are two fixed points. Now 

$${ \underbrace{d(T(p _1), T(p _2))} _{= d(p _1, p _2)} \leq \underbrace{K} _{\text{in } (0, 1)} d(p _1, p _2) , }$$ 

so ${ d(p _1, p _2) = 0 }$ that is ${ p _1 = p _2 . }$    

Let ${ x \in X . }$ Note the sequence of iterates ${ (T ^n (x)) }$ is Cauchy: For all integers ${ m > n > 0  , }$ 

$${ \begin{align*} &d(T ^{m} (x), T ^{n} (x)) \\ \leq &\, K ^n d(T ^{m-n} (x), x) \\ \leq &\, K ^n \left[ d(T ^{m-n} (x), T ^{m-n-1} (x)) + \ldots + d(T(x), x) \right]  \\ \leq &\, K ^n (K ^{m-n-1} + \ldots + 1) \, d(T(x), x) \\ = &\, K ^n \frac{1-K ^{m-n} }{1-K} d(T(x), x) \\ = &\, \frac{K ^n - K ^m}{1-K} d(T(x), x)  . \end{align*} }$$ 

By completeness, there is a ${ p \in X }$ such that 

$${ p = \lim _{n \to \infty} T ^n (x)  . }$$

Since ${ T }$ is continuous, 

$${ \begin{align*}  T(p) = &\, T\, \left( \lim _{n \to \infty} T ^n (x) \right) \\ = &\, \lim _{n \to \infty} T(T ^n (x)) \\ = &\, p   \end{align*}  }$$ 

as needed. ${ \blacksquare }$ 

Basic recall: [Invertibility](https://math.stackexchange.com/a/4620761/303300)/bijectivity of set maps. 

**Def** [${ C ^p }$ isomorphisms]:    
Consider complete normed spaces ${ E, F, }$ and a ${ C ^p }$ map ${ f : U (\subseteq E \text{ open}) \to F . }$    
We say ${ f }$ is a ${ C ^p }$ isomorphism if ${ V := f(U) }$ is open and there is a ${ C ^p }$ map ${ g : V \to U }$ with ${ g \circ f  = \text{id} _{U} }$ and ${ f \circ g = \text{id} _{V} . }$    
(That is, if ${ f }$ maps ${ U }$ bijectively to an open set ${ f(U) , }$ and the inverse ${ f ^{-1} : f(U) \to U }$ is also ${ C ^p }$).    
Let ${ x \in U . }$ We say ${ f }$ is a local ${ C ^p }$ isomorphism at ${ x }$ if there is an open neighbourhood ${ x \in U _1 }$ over which ${ f }$ is a ${ C ^p }$ isomorphism. 

**Obs** [${ C ^p }$ isomorphisms]:    
Consider complete normed spaces ${ E, F, }$ and a ${ C ^p }$ map 

$${ f : U (\subseteq E \text{ open}) \longrightarrow V (\subseteq F \text{ open}).  }$$ 

Further consider complete normed spaces ${ E _1, F _1, }$ and ${ C ^p }$ isomorphisms 

$${ \lambda : U _1 (\subseteq E _1 \text{ open}) \longrightarrow U (\subseteq E \text{ open}),  }$$ 

$${ \mu : V _1 (\subseteq F _1 \text{ open}) \longrightarrow V (\subseteq F \text{ open}).  }$$ 

In this setup, since composition of ${ C ^p }$ isomorphisms is a ${ C ^p }$ isomorphism, 

$${ \begin{align*} &f : U \to V \text{ is a } C ^p \text{ isomorphism} \\ \iff &\, \mu ^{-1} \circ f \circ \lambda :  U _1 \to V _1 \text{ is a } C ^p \text{ isomorphism}. \end{align*} }$$ 

So when trying to show a map is a ${ C ^p }$ isomorphism, we can consider the problem upto composing by known ${ C ^p }$ isomorphisms. 

**Def** [Toplinear isomorphisms]:    
Let ${ E, F }$ be normed spaces, and ${ f : E \to F .}$    
We say ${ f }$ is a toplinear isomorphism of it is an isomorphism of vector spaces and an isomorphism of topological spaces.    
That is, ${ f }$ is a toplinear isomorphism if ${ f : E \to F }$ is continuous linear and there is a ${ g : F \to E  }$ continuous linear with ${ g \circ f = \text{id} _E }$ and ${ f \circ g = \text{id} _F . }$    
The set of toplinear isomorphisms ${ E \to F }$ is written 

$${ L _{\text{is}} (E, F) :=  \lbrace \text{toplinear isomorphisms } E \to F \rbrace . }$$

When ${ E, F }$ are complete, ${ L _{\text{is}} (E, F) }$ is an open subset of ${ L(E, F) .   }$ 

**Obs** [${ \sum _{k=0} ^{\infty} A ^k }$ as a toplinear isomorphism]:    
Let ${ E }$ be a complete normed space and ${ A \in L(E, E) . }$ Now 

$${ \lVert A \rVert < 1 \implies  I-A \in L _{\text{is}} (E, E)   .  }$$ 

For ${ \lVert A \rVert < 1  }$ the inverse ${ (I-A) ^{-1} }$ ${ =  \textstyle \sum _{k=0} ^{\infty} A ^k .  }$    

> Especially ${ \lVert (I - A) ^{-1} \rVert  =  \lVert \sum _{k=0} ^{\infty} A ^k \rVert }$ ${ \leq \sum _{k = 0} ^{\infty} \lVert A \rVert ^k }$ ${ = (I - \lVert A \rVert) ^{-1} . }$ 

**Pf**: Say ${ \lVert A \rVert < 1 . }$ The sequence of partial sums ${ \sum _{k=0} ^n A ^k }$ is Cauchy, because 

$${ \lVert \textstyle \sum _{k=n} ^{m} A ^k \rVert \leq  \textstyle \sum _{k=n} ^{m} \lVert A \rVert ^k   \quad (\text{for } m > n) }$$

and the sequence ${ \sum _{k=0} ^{n} \lVert A \rVert ^k }$ is Cauchy.    
By completeness, ${ \sum _{k=0} ^{\infty} A ^k }$ converges in ${ L(E, E) . }$      

Finally ${ A (\sum _{k = 0} ^{\infty} A ^k) = (\sum _{k = 0} ^{\infty} A ^k) A = (\sum _{k = 0} ^{\infty} A ^k) - I }$ that is 

$${ (I-A) (\textstyle \sum _{k = 0} ^{\infty} A ^k) = (\sum _{k = 0} ^{\infty}  A ^k) (I-A) = I ,     }$$ 

as needed. ${ \blacksquare }$ 

**Obs** [${ L _ {\text{is}} (E, F) }$ is open in ${ L(E, F) }$]:    
Let ${ E, F }$ be complete normed spaces. Now ${ L _{\text{is}} (E, F) }$ is an open subset of ${ L(E, F) . }$    

> For ${ E = F = \mathbb{R} ^n  }$ it is clear: The set of toplinear isomorphisms is ${ L _{\text{is}} (\mathbb{R} ^n , \mathbb{R} ^n) = GL _n (\mathbb{R}), }$ which is preimage of ${ \mathbb{R} \setminus \lbrace 0 \rbrace }$ under the determinant map ${ \text{det} : M _n (\mathbb{R})   \to \mathbb{R} . }$ 

**Pf**: Let ${ A _0 \in L _{\text{is}} (E, F) . }$ We want a ${ \delta > 0 }$ such that 

$${ \text{Want: } \quad \begin{aligned} &\, A \in L(E, F), \, \lVert A - A _0 \rVert < \delta \\ \implies &\, A \in L _{\text{is}} (E, F) \end{aligned}   }$$ 

Note 

$${ \begin{align*} A = &\, A _0 + A - A _0 \\ = &\, A _0 [ \, \text{id} _{E}  + A _0 ^{-1} (A - A _0) \,  ] \\ \end{align*} }$$ 

with ${ \text{id} _E + A _0 ^{-1} (A - A _0) }$ in ${ L (E, E) . }$ It suffices to find a ${ \delta > 0 }$ such that 

$${ \text{Want: } \quad \begin{aligned} &\, A \in L(E, F), \,  \lVert A - A _0 \rVert < \delta \\ \implies  &\, \text{id} _E +  A _0 ^{-1} (A - A _0) \in L _{\text{is}} (E, E) \end{aligned}  }$$ 

Setting ${ \delta := \frac{1}{ 2 \lVert A _0 ^{-1} \rVert}  }$ works, because if ${ \lVert A - A _0 \rVert < \delta }$ 

$${ \lVert - A _0 ^{-1} (A - A _0) \rVert \leq \lVert A _0 ^{-1} \rVert \lVert A - A _0 \rVert < \frac{1}{2} }$$ 

ensures ${ \text{id} _E - (- A _0 ^{-1} (A - A _0))  }$ is a toplinear isomorphism. ${ \blacksquare }$ 

**Obs** [Derivative of ${ \text{inv} }$]:    
Let ${ E, F }$ be complete normed spaces. Then the map 

$${ \text{inv} : L _{\text{is}} (E, F) \longrightarrow  L(F, E), \quad A \mapsto A ^{-1}  }$$ 

is infinitely differentiable, with derivative 

$${ D \, \text{inv} : L _{\text{is}} (E, F) \longrightarrow  L(L(E, F), L(F, E)) }$$ 

given by 

$${ (D \, \text{inv})(A) \, H = - A ^{-1} H  A ^{-1} }$$ 

for ${ A \in L _{\text{is}} (E, F)  }$ and ${ H \in L(E, F) . }$    

> For ${ E = F = \mathbb{R}  }$ it is clear: ${ (D \, \text{inv}) (a) \, h = - a ^{-2} \, h . }$ 

**Pf**: We can first show ${ \text{inv} }$ is continuous. 

* **Obs-1**: ${ \text{inv}  }$ is continuous. 

Let ${ A _0 \in L _{\text{is}} (E, F) , }$ and ${ A \in L(E, F) }$ such that ${ \lVert A - A _0 \rVert < \delta = \frac{1}{2\lVert A _0 ^{-1} \rVert} . }$    
From previous observation, ${ A \in L _{\text{is}} (E, F) }$ and 

$${ A  = A _0 [ \, \text{id} _E + A _0 ^{-1} (A - A _0)  ]  .   }$$ 

Letting ${ \psi (A) := \text{id} _E + A _0 ^{-1} (A - A _0) , }$ we have 

$${ \begin{align*} &\, \text{inv}(A) - \text{inv}(A _0) \\ = &\, \psi(A) ^{-1} A _0 ^{-1} - A _0 ^{-1} \\ = &\,  [\psi (A) ^{-1}  - \text{id} _E \, ] A _0 ^{-1} \\ = &\, \psi (A) ^{-1} [\, \text{id} _E - \psi (A) ]  A _0 ^{-1} \\ = &\, - \psi (A) ^{-1} A _0 ^{-1} (A - A _0) A _0 ^{-1}  .  \end{align*}  }$$ 

Note ${ \lVert \psi (A) ^{-1} \rVert }$ ${ \leq (1- \lVert -  A _0 ^{-1} (A - A _0) \rVert ) ^{-1}.  }$ Hence 

$${ \begin{align*} &\, \lVert \text{inv}(A) - \text{inv}(A _0) \rVert \\ \leq &\, \frac{\lVert A _0 ^{-1} \rVert ^2 \lVert A - A _0 \rVert }{1 - \lVert A _0 ^{-1} (A - A _0) \rVert } \\ \leq &\, \frac{\lVert A _0 ^{-1}  \rVert ^2 \lVert A - A _0 \rVert}{1 - 1/2} , \end{align*}  }$$ 

giving continuity of ${ \text{inv} }$ at ${ A _0 . }$ 

* **Obs-2**: ${ \text{inv} }$ is differentiable. 

Let ${ A _0 \in L _{\text{is}} (E, F) , }$ and ${ H \in L(E, F) }$ such that ${ \lVert H \rVert < \delta = \frac{1}{2\lVert A _0 ^{-1} \rVert} . }$    
From previous observation, ${ A _0 + H \in L _{\text{is}} (E, F) }$ and 

$${ \begin{align*} &\, \text{inv}(A _0 + H) - \text{inv}(A _0) \\ = &\, - \psi (A _0 + H) ^{-1}  A _0 ^{-1} H A _0 ^{-1} . \end{align*} }$$ 

Therefore

$${ \begin{align*} &\, \text{inv}(A _0 + H) - \text{inv}(A _0) + A _0 ^{-1} H A _0 ^{-1} \\ = &\, [ \, \text{id} _E - \psi (A _0 + H) ^{-1} ]  A _0 ^{-1} H A _0 ^{-1} \\ = &\, \underbrace{[\psi(A _0 + H) - \text{id} _E \, ]} _{= \, A _0 ^{-1} H  } \, \underbrace{\psi (A _0 + H) ^{-1} A _0 ^{-1} H A _0 ^{-1}} _{= \, \text{inv}(A _0) - \text{inv}(A _0 + H) } . \end{align*} }$$ 

Now 

$${ H \mapsto - A _0 ^{-1} H A _0 ^{-1}  }$$ 

gives a continuous linear map ${ L(E, F) \to L(F, E), }$ and the error 

$${ \varepsilon (H) := A _0 ^{-1} H \, [\text{inv}(A _0) - \text{inv}(A _0 + H) ] }$$ 

satisfies ${ \frac{\varepsilon(H)}{\lVert H \rVert} \to 0  }$ as ${ H \to 0 . }$    

Hence ${ \text{inv} }$ is differentiable at ${ A _0, }$ with 

$${ (D \, \text{inv}) (A _0) \, H = - A _0 ^{-1} H A _0 ^{-1} .   }$$ 

* **Obs-3**: ${ \text{inv} }$ is infinitely differentiable. 

Consider the continuous bilinear maps 

$${ g : L(F, E) ^2 \longrightarrow L(L(E, F), L(F, E))  }$$ 

$${ g(T _1, T _2) \, S := - T _1 S T _2    }$$ 

and 

$${ h : L(F, E) \longrightarrow L(F, E) ^2  }$$ 

$${ h(T) := (T, T).  }$$ 

From previous observation, 

$${ D \, \text{inv} = g \, \circ  \,  h \, \circ \, \text{inv} .  }$$ 

It is of the form 

$${ D \, \text{inv} = (\text{A } C ^{\infty} \text{ map}) \, \circ \, (\text{A } C ^{\infty} \text{ map}) \, \circ \, \text{inv}  }$$ 

where ${ C ^{\infty} }$ means infinite differentiability.    
So for ${ k \geq 0 ,}$ we have  

$${ \text{inv} \text{ is } C ^k \implies D \, \text{inv} \text{ is } C ^k }$$ 

that is 

$${ \text{inv} \text{ is } C ^k \implies \text{inv} \text{ is } C ^{k+1} . }$$ 

Since ${ \text{inv} }$ is ${ C ^0, }$ by above induction it is ${ C ^{\infty} , }$ as needed. ${ \blacksquare }$ 

With these observations, one can study local invertibility of functions. 

**Thm** [Inverse function theorem]:    
Consider complete normed spaces ${ E, F, }$ and a ${ C ^p }$ map ${ f : U (\subseteq E \text{ open}) \to F . }$ Let ${ x _0 \in U }$ be such that ${ Df(x _0) : E \to F }$ is a toplinear isomorphism.    
Then ${ f }$ is a local ${ C ^p }$ isomorphism at ${ x _0 . }$    

$${ \boxed{\begin{aligned} &\, \textbf{Heuristic: } \text{If } f \text{ is a } C ^p \text{ map, at points where } \\ &\, \text{derivative is ``nonsingular” (in toplinear sense) } \\ &\, f \text{ is a local } C ^p \text{ isomorphism}.  \end{aligned} } }$$ 

**Pf**: We see ${ Df(x _0) ^{-1} f : U \to E }$ is a ${ C ^p }$ map with derivative at ${ x _0 }$ being ${ \text{id} _E . }$ It suffices to show this map ${ f _1 := Df(x _0) ^{-1} f }$ is a local ${ C ^p }$ isomorphism at ${ x _0 . }$    

Let ${ r > 0 }$ be such that ${ B(x _0, r) \subseteq U . }$ It suffices to show ${ f _2 : B(0, r) \to E, }$ ${ f _2 (x) := f _1 (x + x _0)  }$ is a local ${ C ^p }$ isomorphism at ${ 0 . }$    

It suffices to show the translation ${ \hat{f} : B(0, r) \to E,  }$ ${ \hat{f}(x) :=  f _2 (x) - f _2 (0)  }$ is a local ${ C ^p }$ isomorphism at ${ 0 . }$

Here 

$${ \hat{f} : B(0, r) \longrightarrow E, }$$ 

$${ \hat{f}(x) = Df(x _0) ^{-1} [ f(x + x _0) - f(x _0) ] .   }$$ 

It is a ${ C ^p }$ map, ${ D \hat{f}(0) = \text{id} _E }$ and ${ \hat{f}(0) = 0 .  }$ We are to show 

$${ \text{To show: } \quad \hat{f} \text{ is a local } C ^p \text{ isomorphism at } 0 }$$ 

that is 

$${ \text{To show: } \quad \begin{aligned} &\text{There are open neighbourhoods } U, V  \\ &\, \text{of } 0 \text{ such that } \hat{f} \vert _U : U \to V \text{ is a bijection} \\ &\, \text{and } (\hat{f} \vert _U) ^{-1} \text{ is a } C ^p \text{ map.} \end{aligned}  }$$ 

We can proceed by first showing a local bijection. 

* **Obs-1**: There exist ${ R _1, R _2 > 0 }$ (less than ${ r }$) such that ${ \hat{f} }$ gives a bijection ${ B[0, R _1] \to B[0, R _2] . }$ 

We want ${ R _1, R _2 > 0 }$ (less than ${ r }$) such that for every ${ y \in B[0, R _2 ] , }$ the map 

$${ g _y : B(0, r) \longrightarrow E, \quad  g _y (x) := x - \hat{f}(x) + y }$$ 

when viewed as a map ${ B[0, R _1] \to E }$ has a unique fixed point. 

> The maps ${ \hat{f}, g _y }$ (where ${ y \in E }$) are by default defined on ${ B(0, r) . }$ 

Note ${ g _y (x) = g _0 (x) + y . }$    
As ${ Dg _0 (x) = I - D\hat{f}(x) }$ is continuous and ${ Dg _0 (0) = 0, }$ there is an ${ R > 0 }$ (less than ${ r }$) such that 

$${ \lVert x \rVert \leq R \implies \lVert Dg _0 (x) \rVert \leq \frac{1}{2}.  }$$ 

Now for ${ \lVert x \rVert \leq R }$ the term ${ g _0 (x) }$ is bounded as 

$${ \require{cancel} \begin{align*} \lVert g _0 (x) \rVert = &\, \left\lVert \cancel{g _0 (0)} + \int _0 ^1 Dg _0 (tx) \, x \, dt \right\rVert \\ \leq &\, \frac{1}{2} \lVert x \rVert \end{align*} }$$ 

that is 

$${ \lVert x \rVert \leq R \implies \lVert Dg _0 (x) \rVert \leq \frac{1}{2}, \, \lVert g _0 (x) \rVert \leq \frac{1}{2} \lVert x \rVert .  }$$ 

Hence for ${ \lVert x \rVert \leq R }$ and ${ \lVert y \rVert \leq R/2 , }$ 

$${ \begin{align*} \lVert g _y (x) \rVert \leq &\, \lVert g _0 (x) \rVert + \lVert y \rVert \\ \leq &\, \frac{R}{2} + \frac{R}{2} = R . \end{align*}  }$$ 

For every ${ y \in B[0, R/2] , }$ ${ g _y }$ gives a map ${ B[0, R] \to B[0, R].  }$    

In fact for every ${ y \in B[0, R/2] , }$ ${ g _y }$ gives a contraction map ${ B[0, R] \to B[0, R].   }$ 

> Let ${ y \in B[0, R/2]. }$ For ${ x _1, x _2 \in B[0, R], }$ 
> 
> $${ \begin{align*} &\, \lVert g _y (x _2) - g _y (x _1) \rVert \\ = &\, \lVert g _0 (x _2) - g _0 (x _1) \rVert \\ \leq &\, \sup _{x \in [[x _1, x _2]]} \lVert  Dg _0 (x) \rVert \, \,  \lVert x _1 - x _2 \rVert \\ \leq &\, \frac{1}{2} \lVert x _1 - x _2  \rVert .  \end{align*} }$$ 
> 

So for every ${ y \in B[0, R/2] , }$ there is a unique ${ x \in B[0, R] }$ with ${ x - \hat{f}(x) + y = x . }$ 

We observed 

$${  \text{Observed: } \quad \begin{aligned} &\, \text{There is an } R > 0 \text{ such that } \hat{f}   \\ &\, \text{ gives a bijection } B[0, R] \to B[0, R/2]  \end{aligned}  }$$ 

and **Obs-1** is true.    

Further, note for any ${ 0 < R ^{’} \leq R, }$ the argument which gave the bijection 

$${ B[0, R] \to B[0, R/2], \quad x \mapsto \hat{f}(x) }$$ 

gives the bijection 

$${ B[0, R ^{’}] \to B[0, R ^{’} /2], \quad x \mapsto \hat{f}(x) . }$$ 

For the main goal, we want open neighbourhoods ${ U, V }$ of ${ 0 }$ such that ${ \hat{f} }$ maps bijectively ${ U \to V  . }$ 

Fix any ${ 0 < R ^{’} < R . }$ 

The above bijection ${ B[0, R ^{’}] \to B[0, R ^{’} / 2] }$ gives a bijection 

$${ \lbrace x \in B[0, R ^{’}] : \hat{f}(x) \in B(0, R ^{’} /2) \rbrace \to  B(0, R ^{’} / 2) }$$ 

that is 

$${ B[0, R ^{’}] \cap \hat{f} ^{-1} (B(0, R ^{’} /2)) \to  B(0, R ^{’} /2) . }$$ 

The left hand side is an open neighbourhood of ${ 0  }$: 

* **Obs-2**: In the bijection ${ B[0, R ^{’}] \to B[0, R ^{’} /2], }$ we have ${ \lVert x \rVert = R ^{’} \implies \lVert \hat{f}(x) \rVert = R ^{’} /2 . }$    
Especially

$${ \begin{align*} &\, B[0, R ^{’} ] \cap  \hat{f} ^{-1} (B(0, R ^{’} /2)) \\ = &\, B(0, R ^{’}) \cap \hat{f} ^{-1} (B(0, R ^{’} /2)) . \end{align*} }$$ 

Say there is a point ${ x }$ with ${ \lVert x \rVert = R ^{’}  }$ and ${ \lVert \hat{f}(x) \rVert < R ^{’} / 2 . }$    
As ${ \hat{f} }$ is continuous, there is a ${ \delta > 0 }$ such that ${ B(x, \delta) \subseteq B(0, R) }$ and 

$${ t \in B(x, \delta) \implies \lVert \hat{f}(t) \rVert < R ^{’} / 2 .  }$$ 

Pick a point ${ x ^{\ast} \in B(x, \delta) }$ of norm ${ \lVert x ^{\ast} \rVert > \lVert x \rVert . }$ (For example, ${ x + \frac{x}{\lVert x \rVert} \frac{\delta}{2}  .}$ ) Now 

$${ R ^{’}  = \lVert x \rVert < \lVert x ^{\ast} \rVert < R \quad \text{ and } \quad \lVert \hat{f}(x ^{\ast}) \rVert, \lVert \hat{f}(x) \rVert < R ^{’} / 2 .   }$$ 

The ${ B[0, R] \to B[0, R/2] }$ preimage of ${ \hat{f}(x ^{\ast}) }$ is ${ x ^{\ast} . }$ But the bijection ${ B[0, R ^{’} ] \to B[0, R ^{’} / 2] }$ says this preimage must lie in ${ B[0, R ^{’}] , }$ a contradiction.    
Hence **Obs-2** is true. 

Finally 

$${ U := B(0, R ^{’}) \cap \hat{f} ^{-1} (B(0, R ^{’} /2)),  }$$ 

$${ V := B(0, R ^{’} / 2)  }$$ 

are open neighbourhoods of ${ 0 }$ such that 

$${ U \to V, \quad x \mapsto \hat{f}(x)  }$$ 

is a bijection. 

* **Obs-3**: The map ${    V \to U, y \mapsto \hat{f} ^{-1} (y)  }$ is continuous. 

It suffices to show inverse of the bijection ${ B[0, R] \to B[0, R/2] }$ is continuous. 

Any ${ x \in B[0, R] }$ can be written as  

$${ \begin{align*} x = &\, g _0 (x) + (x - g _0 (x)) \\ = &\, g _0 (x) + \hat{f}(x) . \end{align*}  }$$ 

So for all ${ x _1, x _2 \in B[0, R] , }$ we see 

$${ \begin{align*} &\, \lVert x _1 - x _2 \rVert \\ \leq &\, \lVert g _0 (x _1) - g _0 (x _2) \rVert + \lVert \hat{f}(x _1) - \hat{f}(x _2) \rVert \\ \leq &\, \frac{1}{2} \lVert x _1 - x _2 \rVert + \lVert \hat{f}(x _1) - \hat{f}(x _2) \rVert \end{align*} }$$ 

that is 

$${ \frac{1}{2} \lVert x _1 - x _2 \rVert \leq \lVert \hat{f} (x _1) - \hat{f} (x _2) \rVert .  }$$ 

Rewriting this, for all ${ y _1, y _2 \in B[0, R/2], }$ 

$${ \frac{1}{2} \lVert \hat{f} ^{-1} (y _1) - \hat{f} ^{-1} (y _2)  \rVert \leq \lVert y _1 - y _2 \rVert . }$$ 

Hence **Obs-3** is true. 

* **Obs-4**: The map ${ \mathfrak{F} :  V \to U, y \mapsto \hat{f} ^{-1} (y) }$ is differentiable. 

Firstly, for every ${ x \in U }$ the derivative ${ D \hat{f}(x) }$ is a toplinear isomorphism (${ \lVert Dg _0 (x) \rVert }$ ${ = \lVert I - D\hat{f}(x) \rVert }$ ${ \leq \frac{1}{2}}$ so ${ I - (I - D\hat{f}(x)) }$ is invertible). 

Let ${ y _0 \in V  }$ and ${ x _0 := \hat{f} ^{-1} (y _0) . }$ We will show 

$${ \text{Will show: } \quad (D\mathfrak{F})(y _0) = (D \hat{f} )(x _0) ^{-1} .   }$$ 

Let variable ${ y \in V  }$ and ${ x := \hat{f} ^{-1} (y) . }$ We have (for ${ x }$ in a neighbourhood of ${ x _0 }$) 

$${ \begin{align*} &\, \hat{f}(x) = \hat{f}(x _0) + D\hat{f}(x _0) \,  (x - x _0) + \lVert x - x _0 \rVert \varphi (x - x _0) \\ &\, \text{with } \varphi(0) = 0 \text{ and } \varphi \text{ continuous at } 0.   \end{align*}  }$$ 

Rewriting this, 

$${ x = x _0 + D \hat{f} (x _0) ^{-1} \, [\hat{f}(x) - \hat{f} (x _0) - \lVert x - x _0 \rVert \varphi (x - x _0)  ] }$$ 

that is 

$${ \begin{align*} \hat{f} ^{-1} (y) = &\, \hat{f} ^{-1} (y _0) + D \hat{f} (x _0)  ^{-1} \, (y - y _0) \\ &\, -  \lVert x - x _0 \rVert D \hat{f}(x _0) ^{-1} \varphi (x - x _0) . \end{align*}  }$$ 

Note  

$${  \frac{\lVert x - x _0 \rVert D \hat{f}(x _0) ^{-1} \varphi (x - x _0)}{\lVert y - y _0 \rVert} \to 0 \text{ as } y \to y _0   }$$ 

because ${ \lVert x - x _0 \rVert \leq 2 \lVert y - y _0 \rVert    }$ from previous observation. 

Finally 

$${ (D\mathfrak{F}) (y _0) = D\hat{f}(x _0) ^{-1}  }$$ 

and **Obs-4** is true. 

* **Obs-5**: The map ${ \mathfrak{F} :  V \to U, y \mapsto \hat{f} ^{-1} (y) }$ is ${ C ^p . }$

From previous observation, 

$${ D \mathfrak{F} = \text{inv} \, \circ \, D \hat{f} \, \circ \,  \mathfrak{F} .  }$$ 

It is of the form 

$${ D \mathfrak{F} = (\text{A } C ^{\infty} \text{ map}) \, \circ \, (\text{A } C ^{p-1} \text{ map}) \, \circ \, \mathfrak{F} .   }$$ 

So for ${ 0 \leq k \leq p-1 , }$ we have 

$${ \mathfrak{F} \text{ is } C ^k \implies D \mathfrak{F} \text{ is } C ^k  }$$ 

that is 

$${ \mathfrak{F} \text{ is } C ^k \implies \mathfrak{F} \text{ is } C ^{k+1} . }$$ 

Since ${ \mathfrak{F} }$ is ${ C ^0 , }$ by above induction it is ${ C ^p , }$ as needed.   ${ \blacksquare }$ 

